import { MigrationInterface, QueryRunner } from "typeorm";

export class AddTelefonoAvatarUsuario1762462048617 implements MigrationInterface {
    name = 'AddTelefonoAvatarUsuario1762462048617'

    public async up(queryRunner: QueryRunner): Promise<void> {
        await queryRunner.query(`ALTER TABLE \`facturaitem\` DROP FOREIGN KEY \`FK_0df3e672e5109fe12c422961e99\``);
        await queryRunner.query(`ALTER TABLE \`facturaitem\` DROP FOREIGN KEY \`FK_a36d21e668356c7f77366965125\``);
        await queryRunner.query(`ALTER TABLE \`pedidoitem\` DROP FOREIGN KEY \`FK_788f0590951a4073397d143042e\``);
        await queryRunner.query(`ALTER TABLE \`pedidoitem\` DROP FOREIGN KEY \`FK_b0ac2c6863ccd97d636612dddd0\``);
        await queryRunner.query(`ALTER TABLE \`carritoitem\` DROP FOREIGN KEY \`FK_28a75957d5eb83d78ed5ea3812a\``);
        await queryRunner.query(`ALTER TABLE \`carritoitem\` DROP FOREIGN KEY \`FK_52304aa4151370c221b159a6809\``);
        await queryRunner.query(`DROP INDEX \`IDX_ece8be863d7248b96e7362a9cc\` ON \`tipoproducto\``);
        await queryRunner.query(`DROP INDEX \`IDX_67143d7a2c6a26fa4eb1e2bcc8\` ON \`tipoproducto\``);
        await queryRunner.query(`DROP INDEX \`IDX_a36d21e668356c7f7736696512\` ON \`facturaitem\``);
        await queryRunner.query(`DROP INDEX \`IDX_0df3e672e5109fe12c422961e9\` ON \`facturaitem\``);
        await queryRunner.query(`DROP INDEX \`IDX_229e9041935b8aad97c469b941\` ON \`facturaitem\``);
        await queryRunner.query(`DROP INDEX \`IDX_b0ac2c6863ccd97d636612dddd\` ON \`pedidoitem\``);
        await queryRunner.query(`DROP INDEX \`IDX_788f0590951a4073397d143042\` ON \`pedidoitem\``);
        await queryRunner.query(`DROP INDEX \`IDX_4d06ccf0991b9c8acb76a1fa96\` ON \`pedidoitem\``);
        await queryRunner.query(`DROP INDEX \`IDX_f857a6086bd01fec8acbb3e4fa\` ON \`pedidoitem\``);
        await queryRunner.query(`DROP INDEX \`IDX_b59dc3506cf177200c1c7ed636\` ON \`pedidoitem\``);
        await queryRunner.query(`DROP INDEX \`IDX_28a75957d5eb83d78ed5ea3812\` ON \`carritoitem\``);
        await queryRunner.query(`DROP INDEX \`IDX_52304aa4151370c221b159a680\` ON \`carritoitem\``);
        await queryRunner.query(`DROP INDEX \`IDX_072b1551d4ebe483d6ffc47097\` ON \`carritoitem\``);
        await queryRunner.query(`DROP INDEX \`IDX_60742ab91bc7a3b35ba2c3dd96\` ON \`configfiscal\``);
        await queryRunner.query(`DROP INDEX \`IDX_cdf0dfba7535e44af9636cb05c\` ON \`configfiscal\``);
        await queryRunner.query(`ALTER TABLE \`usuario\` ADD \`telefono\` varchar(30) NULL`);
        await queryRunner.query(`ALTER TABLE \`usuario\` ADD \`avatarUrl\` varchar(255) NULL`);
        await queryRunner.query(`ALTER TABLE \`tipoproducto\` ADD UNIQUE INDEX \`IDX_c58a40d10f0365fc7266353f1b\` (\`nombre\`)`);
        await queryRunner.query(`DROP INDEX \`IDX_607f6975fb27b0080592f1b092\` ON \`pago\``);
        await queryRunner.query(`ALTER TABLE \`pago\` CHANGE \`referencia\` \`referencia\` varchar(120) NULL`);
        await queryRunner.query(`ALTER TABLE \`pago\` CHANGE \`evidenciaUrl\` \`evidenciaUrl\` varchar(255) NULL`);
        await queryRunner.query(`ALTER TABLE \`factura\` CHANGE \`evidenciaUrl\` \`evidenciaUrl\` varchar(255) NULL`);
        await queryRunner.query(`ALTER TABLE \`pedido\` CHANGE \`despachadoAt\` \`despachadoAt\` datetime NULL`);
        await queryRunner.query(`ALTER TABLE \`pedido\` CHANGE \`cobradoAt\` \`cobradoAt\` datetime NULL`);
        await queryRunner.query(`ALTER TABLE \`pedidoitem\` CHANGE \`notas\` \`notas\` varchar(255) NULL`);
        await queryRunner.query(`ALTER TABLE \`producto\` CHANGE \`descripcion\` \`descripcion\` varchar(255) NULL`);
        await queryRunner.query(`ALTER TABLE \`carritoitem\` CHANGE \`notas\` \`notas\` varchar(255) NULL`);
        await queryRunner.query(`ALTER TABLE \`auditoria\` DROP COLUMN \`antesJson\``);
        await queryRunner.query(`ALTER TABLE \`auditoria\` ADD \`antesJson\` json NULL`);
        await queryRunner.query(`ALTER TABLE \`auditoria\` DROP COLUMN \`despuesJson\``);
        await queryRunner.query(`ALTER TABLE \`auditoria\` ADD \`despuesJson\` json NULL`);
        await queryRunner.query(`ALTER TABLE \`usuario\` CHANGE \`email\` \`email\` varchar(160) NULL`);
        await queryRunner.query(`ALTER TABLE \`configfiscal\` CHANGE \`vigenteHasta\` \`vigenteHasta\` datetime NULL`);
        await queryRunner.query(`CREATE INDEX \`IDX_b51500beccef4df5446dc0d41d\` ON \`tipoproducto\` (\`estado\`)`);
        await queryRunner.query(`CREATE INDEX \`IDX_b64650a1c508378f811e3c2b32\` ON \`facturaitem\` (\`facturaId\`)`);
        await queryRunner.query(`CREATE INDEX \`IDX_fa38b07776033f58cc041329cb\` ON \`facturaitem\` (\`pedidoItemId\`)`);
        await queryRunner.query(`CREATE INDEX \`IDX_a91d72c9758eae7d001a3cd436\` ON \`facturaitem\` (\`facturaId\`, \`pedidoItemId\`)`);
        await queryRunner.query(`CREATE UNIQUE INDEX \`IDX_607f6975fb27b0080592f1b092\` ON \`pago\` (\`metodo\`, \`referencia\`)`);
        await queryRunner.query(`CREATE INDEX \`IDX_da076777353955b5710178d624\` ON \`pedidoitem\` (\`pedidoId\`)`);
        await queryRunner.query(`CREATE INDEX \`IDX_b24330be9610ff6d39c8423f3c\` ON \`pedidoitem\` (\`productoId\`)`);
        await queryRunner.query(`CREATE INDEX \`IDX_f7cf392903c0d6d4d6dad3a914\` ON \`pedidoitem\` (\`isExtra\`)`);
        await queryRunner.query(`CREATE INDEX \`IDX_e2784fbd63ff45dfab27eb0678\` ON \`pedidoitem\` (\`pedidoId\`, \`createdAt\`)`);
        await queryRunner.query(`CREATE INDEX \`IDX_0bcb05e31de80e0274c6da973a\` ON \`pedidoitem\` (\`pedidoId\`, \`productoId\`, \`isExtra\`)`);
        await queryRunner.query(`CREATE INDEX \`IDX_d7930ec7da2203bed8d7896cdf\` ON \`carritoitem\` (\`carritoId\`)`);
        await queryRunner.query(`CREATE INDEX \`IDX_5cceb0fff2ec3797314219c055\` ON \`carritoitem\` (\`productoId\`)`);
        await queryRunner.query(`CREATE INDEX \`IDX_2b88ba1cb9abd6513c5e93ffde\` ON \`carritoitem\` (\`carritoId\`, \`productoId\`)`);
        await queryRunner.query(`CREATE INDEX \`IDX_99536dfb2db4b2c75cee5d2f3b\` ON \`configfiscal\` (\`vigenteDesde\`)`);
        await queryRunner.query(`CREATE INDEX \`IDX_26f5605685e3d14dbcd2c44ef1\` ON \`configfiscal\` (\`vigenteHasta\`)`);
        await queryRunner.query(`ALTER TABLE \`facturaitem\` ADD CONSTRAINT \`FK_b64650a1c508378f811e3c2b320\` FOREIGN KEY (\`facturaId\`) REFERENCES \`factura\`(\`id\`) ON DELETE CASCADE ON UPDATE RESTRICT`);
        await queryRunner.query(`ALTER TABLE \`facturaitem\` ADD CONSTRAINT \`FK_fa38b07776033f58cc041329cb8\` FOREIGN KEY (\`pedidoItemId\`) REFERENCES \`pedidoitem\`(\`id\`) ON DELETE RESTRICT ON UPDATE RESTRICT`);
        await queryRunner.query(`ALTER TABLE \`pedidoitem\` ADD CONSTRAINT \`FK_da076777353955b5710178d6248\` FOREIGN KEY (\`pedidoId\`) REFERENCES \`pedido\`(\`id\`) ON DELETE CASCADE ON UPDATE RESTRICT`);
        await queryRunner.query(`ALTER TABLE \`pedidoitem\` ADD CONSTRAINT \`FK_b24330be9610ff6d39c8423f3cb\` FOREIGN KEY (\`productoId\`) REFERENCES \`producto\`(\`id\`) ON DELETE RESTRICT ON UPDATE RESTRICT`);
        await queryRunner.query(`ALTER TABLE \`carritoitem\` ADD CONSTRAINT \`FK_d7930ec7da2203bed8d7896cdf3\` FOREIGN KEY (\`carritoId\`) REFERENCES \`carrito\`(\`id\`) ON DELETE CASCADE ON UPDATE RESTRICT`);
        await queryRunner.query(`ALTER TABLE \`carritoitem\` ADD CONSTRAINT \`FK_5cceb0fff2ec3797314219c055f\` FOREIGN KEY (\`productoId\`) REFERENCES \`producto\`(\`id\`) ON DELETE RESTRICT ON UPDATE RESTRICT`);
    }

    public async down(queryRunner: QueryRunner): Promise<void> {
        await queryRunner.query(`ALTER TABLE \`carritoitem\` DROP FOREIGN KEY \`FK_5cceb0fff2ec3797314219c055f\``);
        await queryRunner.query(`ALTER TABLE \`carritoitem\` DROP FOREIGN KEY \`FK_d7930ec7da2203bed8d7896cdf3\``);
        await queryRunner.query(`ALTER TABLE \`pedidoitem\` DROP FOREIGN KEY \`FK_b24330be9610ff6d39c8423f3cb\``);
        await queryRunner.query(`ALTER TABLE \`pedidoitem\` DROP FOREIGN KEY \`FK_da076777353955b5710178d6248\``);
        await queryRunner.query(`ALTER TABLE \`facturaitem\` DROP FOREIGN KEY \`FK_fa38b07776033f58cc041329cb8\``);
        await queryRunner.query(`ALTER TABLE \`facturaitem\` DROP FOREIGN KEY \`FK_b64650a1c508378f811e3c2b320\``);
        await queryRunner.query(`DROP INDEX \`IDX_26f5605685e3d14dbcd2c44ef1\` ON \`configfiscal\``);
        await queryRunner.query(`DROP INDEX \`IDX_99536dfb2db4b2c75cee5d2f3b\` ON \`configfiscal\``);
        await queryRunner.query(`DROP INDEX \`IDX_2b88ba1cb9abd6513c5e93ffde\` ON \`carritoitem\``);
        await queryRunner.query(`DROP INDEX \`IDX_5cceb0fff2ec3797314219c055\` ON \`carritoitem\``);
        await queryRunner.query(`DROP INDEX \`IDX_d7930ec7da2203bed8d7896cdf\` ON \`carritoitem\``);
        await queryRunner.query(`DROP INDEX \`IDX_0bcb05e31de80e0274c6da973a\` ON \`pedidoitem\``);
        await queryRunner.query(`DROP INDEX \`IDX_e2784fbd63ff45dfab27eb0678\` ON \`pedidoitem\``);
        await queryRunner.query(`DROP INDEX \`IDX_f7cf392903c0d6d4d6dad3a914\` ON \`pedidoitem\``);
        await queryRunner.query(`DROP INDEX \`IDX_b24330be9610ff6d39c8423f3c\` ON \`pedidoitem\``);
        await queryRunner.query(`DROP INDEX \`IDX_da076777353955b5710178d624\` ON \`pedidoitem\``);
        await queryRunner.query(`DROP INDEX \`IDX_607f6975fb27b0080592f1b092\` ON \`pago\``);
        await queryRunner.query(`DROP INDEX \`IDX_a91d72c9758eae7d001a3cd436\` ON \`facturaitem\``);
        await queryRunner.query(`DROP INDEX \`IDX_fa38b07776033f58cc041329cb\` ON \`facturaitem\``);
        await queryRunner.query(`DROP INDEX \`IDX_b64650a1c508378f811e3c2b32\` ON \`facturaitem\``);
        await queryRunner.query(`DROP INDEX \`IDX_b51500beccef4df5446dc0d41d\` ON \`tipoproducto\``);
        await queryRunner.query(`ALTER TABLE \`configfiscal\` CHANGE \`vigenteHasta\` \`vigenteHasta\` datetime NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`usuario\` CHANGE \`email\` \`email\` varchar(160) NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`auditoria\` DROP COLUMN \`despuesJson\``);
        await queryRunner.query(`ALTER TABLE \`auditoria\` ADD \`despuesJson\` longtext COLLATE "utf8mb4_bin" NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`auditoria\` DROP COLUMN \`antesJson\``);
        await queryRunner.query(`ALTER TABLE \`auditoria\` ADD \`antesJson\` longtext COLLATE "utf8mb4_bin" NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`carritoitem\` CHANGE \`notas\` \`notas\` varchar(255) NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`producto\` CHANGE \`descripcion\` \`descripcion\` varchar(255) NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`pedidoitem\` CHANGE \`notas\` \`notas\` varchar(255) NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`pedido\` CHANGE \`cobradoAt\` \`cobradoAt\` datetime NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`pedido\` CHANGE \`despachadoAt\` \`despachadoAt\` datetime NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`factura\` CHANGE \`evidenciaUrl\` \`evidenciaUrl\` varchar(255) NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`pago\` CHANGE \`evidenciaUrl\` \`evidenciaUrl\` varchar(255) NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`pago\` CHANGE \`referencia\` \`referencia\` varchar(120) NULL DEFAULT 'NULL'`);
        await queryRunner.query(`CREATE UNIQUE INDEX \`IDX_607f6975fb27b0080592f1b092\` ON \`pago\` (\`metodo\`, \`referencia\`)`);
        await queryRunner.query(`ALTER TABLE \`tipoproducto\` DROP INDEX \`IDX_c58a40d10f0365fc7266353f1b\``);
        await queryRunner.query(`ALTER TABLE \`usuario\` DROP COLUMN \`avatarUrl\``);
        await queryRunner.query(`ALTER TABLE \`usuario\` DROP COLUMN \`telefono\``);
        await queryRunner.query(`CREATE INDEX \`IDX_cdf0dfba7535e44af9636cb05c\` ON \`configfiscal\` (\`vigenteHasta\`)`);
        await queryRunner.query(`CREATE INDEX \`IDX_60742ab91bc7a3b35ba2c3dd96\` ON \`configfiscal\` (\`vigenteDesde\`)`);
        await queryRunner.query(`CREATE INDEX \`IDX_072b1551d4ebe483d6ffc47097\` ON \`carritoitem\` (\`carritoId\`, \`productoId\`)`);
        await queryRunner.query(`CREATE INDEX \`IDX_52304aa4151370c221b159a680\` ON \`carritoitem\` (\`productoId\`)`);
        await queryRunner.query(`CREATE INDEX \`IDX_28a75957d5eb83d78ed5ea3812\` ON \`carritoitem\` (\`carritoId\`)`);
        await queryRunner.query(`CREATE INDEX \`IDX_b59dc3506cf177200c1c7ed636\` ON \`pedidoitem\` (\`pedidoId\`, \`productoId\`, \`isExtra\`)`);
        await queryRunner.query(`CREATE INDEX \`IDX_f857a6086bd01fec8acbb3e4fa\` ON \`pedidoitem\` (\`pedidoId\`, \`createdAt\`)`);
        await queryRunner.query(`CREATE INDEX \`IDX_4d06ccf0991b9c8acb76a1fa96\` ON \`pedidoitem\` (\`isExtra\`)`);
        await queryRunner.query(`CREATE INDEX \`IDX_788f0590951a4073397d143042\` ON \`pedidoitem\` (\`productoId\`)`);
        await queryRunner.query(`CREATE INDEX \`IDX_b0ac2c6863ccd97d636612dddd\` ON \`pedidoitem\` (\`pedidoId\`)`);
        await queryRunner.query(`CREATE INDEX \`IDX_229e9041935b8aad97c469b941\` ON \`facturaitem\` (\`facturaId\`, \`pedidoItemId\`)`);
        await queryRunner.query(`CREATE INDEX \`IDX_0df3e672e5109fe12c422961e9\` ON \`facturaitem\` (\`pedidoItemId\`)`);
        await queryRunner.query(`CREATE INDEX \`IDX_a36d21e668356c7f7736696512\` ON \`facturaitem\` (\`facturaId\`)`);
        await queryRunner.query(`CREATE INDEX \`IDX_67143d7a2c6a26fa4eb1e2bcc8\` ON \`tipoproducto\` (\`estado\`)`);
        await queryRunner.query(`CREATE UNIQUE INDEX \`IDX_ece8be863d7248b96e7362a9cc\` ON \`tipoproducto\` (\`nombre\`)`);
        await queryRunner.query(`ALTER TABLE \`carritoitem\` ADD CONSTRAINT \`FK_52304aa4151370c221b159a6809\` FOREIGN KEY (\`productoId\`) REFERENCES \`producto\`(\`id\`) ON DELETE RESTRICT ON UPDATE RESTRICT`);
        await queryRunner.query(`ALTER TABLE \`carritoitem\` ADD CONSTRAINT \`FK_28a75957d5eb83d78ed5ea3812a\` FOREIGN KEY (\`carritoId\`) REFERENCES \`carrito\`(\`id\`) ON DELETE CASCADE ON UPDATE RESTRICT`);
        await queryRunner.query(`ALTER TABLE \`pedidoitem\` ADD CONSTRAINT \`FK_b0ac2c6863ccd97d636612dddd0\` FOREIGN KEY (\`pedidoId\`) REFERENCES \`pedido\`(\`id\`) ON DELETE CASCADE ON UPDATE RESTRICT`);
        await queryRunner.query(`ALTER TABLE \`pedidoitem\` ADD CONSTRAINT \`FK_788f0590951a4073397d143042e\` FOREIGN KEY (\`productoId\`) REFERENCES \`producto\`(\`id\`) ON DELETE RESTRICT ON UPDATE RESTRICT`);
        await queryRunner.query(`ALTER TABLE \`facturaitem\` ADD CONSTRAINT \`FK_a36d21e668356c7f77366965125\` FOREIGN KEY (\`facturaId\`) REFERENCES \`factura\`(\`id\`) ON DELETE CASCADE ON UPDATE RESTRICT`);
        await queryRunner.query(`ALTER TABLE \`facturaitem\` ADD CONSTRAINT \`FK_0df3e672e5109fe12c422961e99\` FOREIGN KEY (\`pedidoItemId\`) REFERENCES \`pedidoitem\`(\`id\`) ON DELETE RESTRICT ON UPDATE RESTRICT`);
    }

}
